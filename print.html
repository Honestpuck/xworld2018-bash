<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Tony Williams">
  <title>Beginning Bash</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="reveal.js/css/theme/white.css" id="theme">
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
  <h1 class="title">Beginning Bash</h1>
  <p class="author">Tony Williams</p>
  <p class="date">X World 2018</p>
</section>

<section id="getting-a-terminal-app" class="slide level3">
<h3>Getting A Terminal App</h3>
<ul>
<li>iTerm2</li>
</ul>
<aside class="notes">
<p>This year I'm going to teach this workshop a little differently than I did two years ago. I'm going to concentrate less on syntax and more on examples and regular expressions.</p>
<p>Before we get on to the shell I'd like to say a few words about the Terminal app. Number one is don't use it. Use iTerm2 instead.</p>
</aside>
</section>
<section id="setting-preferences" class="slide level3">
<h3>Setting Preferences</h3>
<aside class="notes">
<p>The second is to get away from historical absurdities. Back when I started programming we used physical terminals that produced only 80 characters by 24 lines on a 12 or 14 inch monitor. We can give that up, there's no need to emulate that in 2018. Set your default window size to something more sensible and also a larger font. I use 110 characters by 40 lines and an 18pt font for these old eyes.</p>
</aside>
</section>
<section id="install-homebrew" class="slide level3">
<h3>Install Homebrew</h3>
<aside class="notes">
<p>So step number one in getting the shell working right is installing homebrew. Then you can use homebrew to install a few necessities. I'd number bash completion the top of that list.</p>
<p>By the way, after you install bash completion there are a number of extensions for Apple command line tools that I've written. You can get them at my github page.</p>
</aside>
</section>
<section id="variables" class="slide level3">
<h3>Variables</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">WORD=</span><span class="st">&quot;Foobar&quot;</span>
<span class="bu">echo</span> <span class="va">$WORD</span></code></pre></div>
<aside class="notes">
<p>Open up your terminal and give that a try. Here we set the bash variable WORD.</p>
</aside>
</section>
<section id="section" class="slide level3">
<h3></h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">WORD=</span><span class="st">&quot;Foobar&quot;</span> ; <span class="bu">echo</span> <span class="va">$WORD</span></code></pre></div>
<aside class="notes">
<p>Notice the semi colon - we use that to separate two commands on the one line.</p>
</aside>
</section>
<section id="using-a-command" class="slide level3">
<h3>Using A Command</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="fu">id</span> -un
<span class="va">username=</span><span class="kw">`</span><span class="fu">id</span> -un<span class="kw">`</span>
<span class="bu">echo</span> <span class="va">$username</span>
<span class="bu">unset</span> <span class="va">username</span>
<span class="bu">echo</span> <span class="va">$username</span>
<span class="va">username=$(</span><span class="fu">id</span> -un<span class="va">)</span>
<span class="bu">echo</span> <span class="va">$username</span></code></pre></div>
<aside class="notes">
<p>You can also set a variable to the output of a command. Follow along with me here <DEMO></p>
</aside>
</section>
<section id="special-variables" class="slide level3">
<h3>Special variables</h3>
<pre><code>export CDPATH=&quot;.:~:~/Library:~/Dropbox:~/dev:~/Documents&quot;</code></pre>
<aside class="notes">
<p>bash has a number of special variables. We can set them so that life is easier. One of my favourites is CDPATH</p>
</aside>
</section>
<section id="aliases" class="slide level3">
<h3>Aliases</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">LS_OPTIONS=</span><span class="st">&quot;--color=auto -F -G&quot;</span>
<span class="co"># standard ls coloured</span>
<span class="bu">alias</span> ls=<span class="st">&#39;gls $LS_OPTIONS&#39;</span>
<span class="co"># standard plus dot files</span>
<span class="bu">alias</span> la=<span class="st">&#39;gls $LS_OPTIONS -A&#39;</span>

<span class="bu">alias</span> profile=<span class="st">&#39;bbedit -b ~/.bash_profile&#39;</span>
<span class="bu">alias</span> flushDNS=<span class="st">&#39;dscacheutil -flushcache&#39;</span></code></pre></div>
<aside class="notes">
<p>In your bash profile you can start a little bash programming. The simplest bash programming is aliases. We use aliases for providing common or hard to remember options for commands. Here's a couple of examples.</p>
</aside>
</section>
<section id="functions" class="slide level3">
<h3>Functions</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># function to send man page to preview</span>
<span class="fu">manp()</span>
<span class="kw">{</span>
    <span class="fu">man</span> -t <span class="va">$*</span> <span class="kw">|</span> <span class="ex">open</span> -f -a /Applications/Preview.app/
<span class="kw">}</span></code></pre></div>
<aside class="notes">
<p>Now with aliases the variable part for it must be at the end. If we want something different we have to use a function. Here's a useful function.</p>
<p>I have included a copy of my bash profile so you can see what other possibilities there are.</p>
<p>Now let's move on to the simple end of bash syntax. This one is also from my bash profile.</p>
</aside>
</section>
<section id="example-decision" class="slide level3">
<h3>Example Decision</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co"># make root red</span>
<span class="kw">if</span><span class="bu"> [</span> <span class="kw">`</span><span class="fu">id</span> -u<span class="kw">`</span> <span class="ot">=</span> 0<span class="bu"> ]</span>
<span class="kw">then</span>
        <span class="va">PS1=</span><span class="st">&quot;\[\033[31m\]\h:\W \u</span><span class="dt">\$</span><span class="st">\[\033[0m\] &quot;</span>
<span class="kw">fi</span></code></pre></div>
<aside class="notes">
<p>An if statement. In this one we decide if we want to change the colour of the prompt depending if we are <code>root</code> or not. Note the <code>id -u</code> between the backticks. When we place a command between backticks the command is run and the output is used. Here we have the <code>id</code> shell command print our user ID, which is 0 if we are root.</p>
</aside>
</section>
<section id="checking-the-result-code" class="slide level3">
<h3>Checking The Result Code</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">if</span> <span class="fu">ls</span> mysillyfilename <span class="kw">;</span> <span class="kw">then</span>
    <span class="bu">echo</span> <span class="st">&quot;File exists.&quot;</span>
<span class="kw">fi</span>

<span class="co"># checking result code variable</span>
<span class="fu">ls</span> mysillyfilename
<span class="kw">if</span><span class="bu"> [</span> <span class="va">$?</span> <span class="ot">=</span> 0<span class="bu"> ]</span> ; <span class="kw">then</span>
    <span class="bu">echo</span> <span class="st">&quot;File exists.&quot;</span>
<span class="kw">fi</span></code></pre></div>
<aside class="notes">
<p>We can use the result from any command in an <code>if</code> statement. The special variable <code>$?</code> saves the result of the last command.</p>
</aside>
</section>
<section id="checking-a-file" class="slide level3">
<h3>Checking A File</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">if</span><span class="bu"> [</span> <span class="ot">-e</span> README.md<span class="bu"> ]</span> ; <span class="kw">then</span>
    <span class="bu">echo</span> <span class="st">&quot;Readme exists&quot;</span>
<span class="kw">fi</span></code></pre></div>
<aside class="notes">
<p>We can also test files, their existence and type. Here we use <code>-e</code> to test that the file exists.</p>
</aside>
</section>
<section id="file-checks" class="slide level3">
<h3>File Checks</h3>
<table>
<tbody>
<tr class="odd">
<td style="text-align: center;">-a</td>
<td style="text-align: left;">if file exists</td>
<td style="text-align: center;">-d</td>
<td style="text-align: left;">if file is directory</td>
</tr>
<tr class="even">
<td style="text-align: center;">-e</td>
<td style="text-align: left;">if file exists</td>
<td style="text-align: center;">-r</td>
<td style="text-align: left;">if file is readable</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-w</td>
<td style="text-align: left;">if file is writeable</td>
<td style="text-align: center;">-x</td>
<td style="text-align: left;">if file is executable</td>
</tr>
<tr class="even">
<td style="text-align: center;">-O</td>
<td style="text-align: left;">is owned by the user</td>
<td style="text-align: center;">-G</td>
<td style="text-align: left;">is owned by the group</td>
</tr>
</tbody>
</table>
<aside class="notes">
<p>Here is a list of some of the more useful file tests. <code>man test</code> will get you a comprehensive list and a list of all the comparison operators for strings and numbers</p>
</aside>
</section>
<section id="round-and-round" class="slide level3">
<h3>Round And Round</h3>
<ul>
<li>For</li>
<li>While</li>
<li>Done</li>
</ul>
</section>
<section id="while-loop" class="slide level3">
<h3>While Loop</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>
<span class="va">WORD=</span><span class="st">&quot;Start&quot;</span>
<span class="kw">while</span><span class="bu"> [</span> <span class="st">&quot;</span><span class="va">$WORD</span><span class="st">&quot;</span> <span class="ot">!=</span> <span class="st">&quot;&quot;</span><span class="bu"> ]</span> ; <span class="kw">do</span>
<span class="bu">echo</span> -n <span class="st">&quot;Word: &quot;</span> <span class="kw">;</span> <span class="bu">read</span> <span class="va">WORD</span>
    <span class="kw">case</span> <span class="st">&quot;</span><span class="va">$WORD</span><span class="st">&quot;</span><span class="kw"> in</span>
        <span class="kw">(</span> <span class="st">&quot;Foo&quot;</span> <span class="kw">)</span>       <span class="bu">echo</span> <span class="st">&quot;Bar&quot;</span> <span class="kw">;;</span>
        <span class="kw">(</span> <span class="st">&quot;Bar&quot;</span> <span class="kw">)</span>       <span class="bu">echo</span> <span class="st">&quot;Foo&quot;</span> <span class="kw">;;</span>
        <span class="kw">(</span> <span class="st">&quot;FooBar&quot;</span> <span class="kw">)</span>    <span class="bu">echo</span> <span class="st">&quot;No Way&quot;</span> <span class="kw">;;</span>
        <span class="kw">(</span> <span class="st">&quot;&quot;</span> <span class="kw">)</span> <span class="kw">;;</span>
        <span class="kw">(</span> * <span class="kw">)</span>           <span class="bu">echo</span> <span class="st">&quot;FooBar&quot;</span> <span class="kw">;;</span>
    <span class="kw">esac</span>
<span class="kw">done</span></code></pre></div>
<aside class="notes">
<p>A while loop. So long as the statement is true it will loop forever. In <code>while.sh</code>.</p>
</aside>
</section>
<section id="for-ever" class="slide level3">
<h3>For Ever</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">for</span> <span class="fu">file</span> in *.sh <span class="kw">;</span> <span class="kw">do</span>
    <span class="bu">echo</span> <span class="va">$file</span>
<span class="kw">done</span></code></pre></div>
<aside class="notes">
<p>A for loop. The echo statement will run for each item in <code>*.sh</code>. In <code>for.sh</code>.</p>
</aside>
</section>
<section id="expanding-variables" class="slide level3">
<h3>Expanding Variables</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">LIST=</span><span class="st">&quot;Foo Bar Baz&quot;</span>
<span class="kw">for</span> <span class="ex">i</span> in <span class="va">$LIST</span> <span class="kw">;</span> <span class="kw">do</span>
    <span class="bu">echo</span> <span class="va">$i</span>
<span class="kw">done</span></code></pre></div>
<aside class="notes">
<p>We can also loop through items in a variable.</p>
</aside>
</section>
<section id="field-separator" class="slide level3">
<h3>Field Separator</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">IFS=</span><span class="st">&quot;:&quot;</span>
<span class="va">LIST=</span><span class="st">&quot;a:b:c d&quot;</span>
<span class="kw">for</span> <span class="ex">i</span> in <span class="va">$LIST</span> <span class="kw">;</span> <span class="kw">do</span>
    <span class="bu">echo</span> <span class="va">$i</span>
<span class="kw">done</span></code></pre></div>
<aside class="notes">
<p>What defines an &quot;item&quot; is the Internal Field Seperator or IFS. Here we change it to a colon. In <code>expand.sh</code>.</p>
</aside>
</section>
<section id="redirection" class="slide level3">
<h3>Redirection</h3>
</section>
<section id="how-its-done" class="slide level3">
<h3>How It's Done</h3>
<ul>
<li>Fresh output <code>ls &gt; files.txt</code></li>
<li>Append to the file <code>ls &gt;&gt; files.txt</code></li>
</ul>
<aside class="notes">
<p>We can take the output of a command and redirect it to a file. A single greater than will overwrite an existing file, two will append to the end of an existing file. Both will create the file if it doesn't exist.</p>
</aside>
</section>
<section id="using-tee" class="slide level3">
<h3>Using tee</h3>
<ul>
<li>Fresh file <code>ls | tee files.txt</code></li>
<li>Append to the file <code>ls | tee -a files.txt</code></li>
</ul>
<aside class="notes">
<p><code>tee</code> allows us to redirect the output to a file <em>and</em> see it in the terminal.</p>
</aside>
</section>
<section id="both-out-and-err" class="slide level3">
<h3>Both OUT and ERR</h3>
<p>If you want to log to the same file: <code>command1 &gt;&gt; log_file 2&gt;&amp;1</code></p>
If you want different files: <code>command1 &gt;&gt; log_file 2&gt;&gt; err_file</code>
<aside class="notes">
<p>There are actually <em>two</em> outputs. The &quot;ordinary&quot; one, STDOUT and one for errors, STDERR. They are numbered 1 and 2 respectively and we can direct them both if we want.</p>
</aside>
</section>
<section id="maths-using-expr" class="slide level3">
<h3>Maths Using <code>expr</code></h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>

<span class="va">WEEKS=$1</span>
<span class="va">DAYS=</span><span class="kw">`</span><span class="fu">expr</span> <span class="va">$WEEKS</span> <span class="st">&#39;*&#39;</span> <span class="st">&#39;7&#39;</span><span class="kw">`</span>
<span class="fu">date</span> -v +<span class="va">${DAYS}</span>d</code></pre></div>
<aside class="notes">
<p>We can do maths in scripts using the <code>expr</code> command. In <code>weeks.sh</code>.</p>
</aside>
</section>
<section id="maths-using-expansion" class="slide level3">
<h3>Maths Using Expansion</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>

<span class="va">WEEKS=$1</span>
<span class="va">DAYS=$(($WEEKS</span>*7<span class="va">))</span>
<span class="fu">date</span> -v +<span class="va">${DAYS}</span>d</code></pre></div>
<p>Or even <code>echo $(( 7 * ( 4 + 2 ) ))</code> Though the spaces are not required <code>echo $((7*(4+2)))</code></p>
<aside class="notes">
<p>It often looks clearer to use shell arithmetic expansion for maths.</p>
</aside>
</section>
<section id="improve-the-look" class="slide level3">
<h3>Improve The Look</h3>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">WEEKS=$1</span>
<span class="va">DAYS=</span><span class="kw">`</span><span class="fu">expr</span> <span class="va">$WEEKS</span> <span class="st">&#39;*&#39;</span> <span class="st">&#39;7&#39;</span><span class="kw">`</span>
<span class="fu">date</span> -v +<span class="va">${DAYS}</span>d <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{ print $1 &quot; &quot; $2 &quot; &quot; $3 &quot; &quot; $4 }&#39;</span></code></pre></div>
<aside class="notes">
<p>We can pipe the output of the <code>date</code> command to a utility called <code>awk</code>. This is a powerful text processing language but here we just use a simple command. This one just prints some of the fields. Awk is often used to trim or reformat the output of another command. In <code>weeks2.sh</code>.</p>
</aside>
</section>
<section id="looking-at-some-examples" class="slide level3">
<h3>Looking At Some Examples</h3>
<aside class="notes">
<p>Here I will go through some examples from simple shell scripts that I have written at work. They contain no Suncorp data or passwords.</p>
</aside>
</section>
    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({

        // Optional reveal.js plugins
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
              { src: 'reveal.js/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
